{"variables":{"variable_buffer":{},"global_variables":{"employees_answers":[],"employees":[],"current_norm":"","data_path":"C:\\Users\\User\\Desktop\\Data\\","current_md":"","compliance_factor":"","manager_mail":"","employee_mail":"","coefficient_value":""}},"actions":{"QTp1xmWYC5":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{employees_answers}}[{{i}}][{{key}}]","timing_after":0.1,"timing_before":0,"timing_between":0},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"wxZBWGbUa6"},"LiNfD6gKod":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"maximize","func_params":{"wait_appear":2,"set_focus":false},"breakpoint":false,"class_params":{},"inherit_object":"ESvmzN7S9f","if_error":{"go_to":null,"repeat":3,"counter":0,"delay":null},"next_id":"N4Sx1lKnrG"},"ooJv075YFi":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"minimize","func_params":{"wait_appear":2,"set_focus":false},"breakpoint":false,"class_params":{},"inherit_object":"wzfPVEtf3O","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"LiNfD6gKod"},"8Fo7SeGcxB":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8MDIClient","control_type":"Pane","title":"Рабочее пространство"},{"control_type":"Window","class_name":"V8MDILocalFrame"},{"class_name":"V8LayouterTabsWindow","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8CommandBar","control_type":"ToolBar","title":""},{"class_name":"","control_type":"Button","title":"ОК"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ooJv075YFi"},"m1SG0yt7UI":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8MDIClient","control_type":"Pane","title":"Рабочее пространство"},{"control_type":"Window","class_name":"V8MDILocalFrame"},{"class_name":"V8LayouterTabsWindow","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8CommandBar","control_type":"ToolBar","title":""},{"class_name":"","control_type":"Button","title":"Записать"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"8Fo7SeGcxB"},"wRyDLUxdT2":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"space","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"m1SG0yt7UI"},"-H594wbEqy":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"wRyDLUxdT2"},"mmLzgaMsqd":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{coefficient_value}}","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"-H594wbEqy"},"zGMbP3ZQHn":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"mmLzgaMsqd"},"Z87xMPGCZN":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"from docx import Document\r\nimport re\r\n\r\ndef convert_to_float(value):\r\n    try:\r\n        return float(value.replace(',', '.'))\r\n    except ValueError:\r\n        return None\r\n\r\ndocx_path = f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\n\r\ndoc = Document(docx_path)\r\n\r\npattern = re.compile(r\"Коэффициент соответствия норме: (\\d+[\\.,]\\d+)\")\r\n\r\nresult = None\r\n\r\nfor paragraph in doc.paragraphs:\r\n    match = pattern.search(paragraph.text)\r\n    if match:\r\n        coefficient_value_str = match.group(1)\r\n        result = convert_to_float(coefficient_value_str)\r\n        {{coefficient_value}} = result\r\n        break"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"zGMbP3ZQHn"},"XDicMhGdhp":{"name":"IF..ELSE","module":"pyPythonRPA.Robot.pythonRPA","class":"conditions","function":"if_else","class_params":{},"func_params":{"condition":"float({{current_md}}) <= 8","if_case":"Z87xMPGCZN","else_case":"m1SG0yt7UI"},"results":null,"object":null,"inherit_object":null,"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"1-LHT1cqLY":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{current_norm}}","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"XDicMhGdhp"},"2Xs7faTn0g":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"1-LHT1cqLY"},"7_3YqLpZXe":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{current_md}}","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"2Xs7faTn0g"},"w-POTsPboz":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"7_3YqLpZXe"},"wpPqTeYE7y":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{employees}}[{{i}}][4]","timing_after":1,"timing_before":0,"timing_between":0.2},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"w-POTsPboz"},"PFw8rPz2Md":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"wpPqTeYE7y"},"TjQ7iX1lJn":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"КЛО","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"PFw8rPz2Md"},"4xxnk8MUTF":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"insert","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"TjQ7iX1lJn"},"rame2iieqI":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAACcAAAAVCAIAAABKc2DEAAABx0lEQVR4nO2UsWsaURzHP1pJQe51SS6cQoRAzRGKDnUsmIB/QSWDrulUCDhkyyJZut1QuNnVJdihYwnYgJsn9ESKaUC4wHnkFuGEFJrSDheDVaonNDf1Oz0en/f7vPeD34v8+jEi9ETDV/63hpDYz7s7xxmMRu7329vQrJEv7Y9PolHxTMTj8dCssadra+sb66H5/ETDVwKxR6h5PfxqAWykEvLWqtZWp1qxKeZOTxKAW/+sax5Z9eiNp1fsOVoUPuzlt4Znh0bXBISC5wBZ9aiWllewTmWiTJZqabnVAR5uA+OLw+a56S+MrolyvP+2LE1O9fV30oR8SJB5bXV0zYNkqfZydwFmDXsmZNWDsuRvyOWdDNC4vLieQZdaG0a1YkOy1F6oBCzPAZ5LU/1MvCgC3o21qvU+drM+XkzcDDxA2RYBqi23isJ7VQFHM+Ya9Uc2twXgDLx/YS3u5F+lD44FeOfVb+4CMiUU4Go8xQx7DUBspla1AiCXc4UsmP2z+ti1/vKaVHq/eM/4G279suvfe3Zqg/4SUv5U7b3uO1pTBxCZvcQ8tHuSy1wZXa1Z/SQUczKvs2MDRFy7HVAcOMv/psewLs9vDAqjjosCmq4AAAAASUVORK5CYII=","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"4xxnk8MUTF"},"9Qv8GVwTSC":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAEwAAAAVCAIAAABjdJ9DAAACLElEQVR4nOWXT2jTUADGv7U5uGDHYOrGrHZSPe0kUrIR1kvZJafCMDB28+AtkCql7NJDL6MMZ2A9eZgnDXQoOeXSWyRsVa87jeJa3kJZLcup03nQQ0ZZm6RaSVbIfuTweO8L7/vev7yM/f5lIuiERm3gKrgWIaljcmiarR9nZ6N24hk3xscnJ2/PzDwIU5RVQ5mnJ5GJyPT0ndE685BOp2OenrTbzYePHtP0TQBjLePrqF35Qvt7++f5+fz8YpiiArsnp25NhUOhZvMbgn3wRCYiptlCsEPSNG0dqJS7Ri9xL7TLFamt8kvWZ2O+MCAkgHRWXU9Yxf0NXr8CP74Q5OXaZfiQRC4JDM8xvLDxBQCRsxzDdx9BNuyaPpkgG0TOWkqrqbfG2H3Gd1u9wD0kadTjc3dttUpRwtqHslqVkoebr3QAiIuSWi2r1fIbMeam6couNO4Q+fXbg/+N48zgPWl38EmHmFmIAphdXI5pDYfxdtCws3ZZTRI56aIcF7svK8UKmxfxbjhfg3GdSWOvguSSgzmv6J9/ADjezevJQjrqcVduIcln7SB2z9ZbdImF9HGfADD2KvW5+w6j8C8aR2rSpraceep1RJflShRh5X0NKDA930ko/JEo5URSXOELQFyUtlmQhu31aDonli5roJeeS0ht/TVtcm21V6OXOI1R1xMOhSFwvKATRcgjt9O/bIicLSKzverjGvaa+lH9SSIV2L8QCyvktbgM/AFPxvQC1BD8IQAAAABJRU5ErkJggg==","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"rame2iieqI"},"VkCy3oqhzD":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import os\r\nimport shutil\r\n\r\nsource_file_path = f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\ndestination_folder_path = f\"{{{data_path}}}\\\\Нет_В_1с\"\r\ntry:\r\n    shutil.move(source_file_path, destination_folder_path)\r\nexcept shutil.Error:\r\n    pass"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ooJv075YFi"},"iLyKCq1eP4":{"name":"WAIT FOR SELECTOR TO APPEAR","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"wait_appear","func_params":{"sec":15},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8MDIClient","control_type":"Pane","title":"Рабочее пространство"},{"control_type":"Window","class_name":"V8MDILocalFrame"},{"class_name":"V8LayouterTabsWindow","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8LayouterTabsWindow","control_type":"Tab","title":"Общие"},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Button","title":""}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":"VkCy3oqhzD","repeat":null,"counter":0,"delay":null},"next_id":"9Qv8GVwTSC"},"UAAbUoYfo3":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"f2","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"iLyKCq1eP4"},"R0y8bea7c9":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"right","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"UAAbUoYfo3"},"Ljg8BPL97O":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":1,"timing_before":0,"n_time":2},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"R0y8bea7c9"},"48eTTqNLdO":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8NewLocalFrameBaseWnd","control_type":"Window","title":"1С:Предприятие"},{"class_name":"V8LayouterTabsWindow","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Button","title":"Да"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Ljg8BPL97O"},"sA8aRNlNZu":{"name":"IF..ELSE","module":"pyPythonRPA.Robot.pythonRPA","class":"conditions","function":"if_else","class_params":{},"func_params":{"condition":"{%LFL4hFU9KA%}","if_case":"48eTTqNLdO","else_case":"Ljg8BPL97O"},"results":null,"object":null,"inherit_object":null,"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"LFL4hFU9KA":{"name":"CHECK SELECTOR","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"is_exists","func_params":{},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8NewLocalFrameBaseWnd","control_type":"Window","title":"1С:Предприятие"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"sA8aRNlNZu"},"CvHzgZDCCQ":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{employees}}[{{i}}][0] + \" \" + {{employees}}[{{i}}][1] + \" \" + {{employees}}[{{i}}][2]","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"LFL4hFU9KA"},"8OpBF_h9gt":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8MDIClient","control_type":"Pane","title":"Рабочее пространство"},{"class_name":"V8MDILocalFrame","control_type":"Window","title":"Физические лица"},{"class_name":"V8LayouterTabsWindow","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"Pane","title":""},{"class_name":"V8FormElement","control_type":"ComboBox","title":""}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"CvHzgZDCCQ"},"cCmYfGtO2D":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8PopupBar","control_type":"Menu","title":"Кадровый учет"},{"class_name":"","control_type":"MenuItem","title":"Физические лица"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":3,"counter":0,"delay":1},"next_id":"8OpBF_h9gt"},"aySksxvy-B":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8Dockbar","control_type":"Pane","title":""},{"class_name":"V8CommandBarDockFrame","control_type":"Pane","title":""},{"class_name":"V8CommandBar","control_type":"ToolBar","title":"Главное меню"},{"class_name":"","control_type":"Button","title":"Кадровый учет"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"cCmYfGtO2D"},"d1LbCbD95x":{"name":"WAIT FOR SELECTOR TO APPEAR","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"wait_appear","func_params":{"sec":30},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8PopupBar","control_type":"Menu","title":"Кадровый учет"},{"class_name":"","control_type":"MenuItem","title":"Физические лица"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":"aySksxvy-B","repeat":null,"counter":0,"delay":null},"next_id":"cCmYfGtO2D"},"Mo2zvil5PW":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"},{"class_name":"V8Dockbar","control_type":"Pane","title":""},{"class_name":"V8CommandBarDockFrame","control_type":"Pane","title":""},{"class_name":"V8CommandBar","control_type":"ToolBar","title":"Главное меню"},{"class_name":"","control_type":"Button","title":"Кадровый учет"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":3,"counter":0,"delay":1},"next_id":"d1LbCbD95x"},"wzfPVEtf3O":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"maximize","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"V8TopLevelFrame","title":"1С:Предприятие - Управление производственным предприятием для Казахстана, редакция 1.3 / Акционерное общество  \"Костанайские минералы\" / Костанайские Минералы / Robot_1C","backend":"uia"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Mo2zvil5PW"},"ESvmzN7S9f":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"minimize","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"wzfPVEtf3O"},"t--fqmyZ9f":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import smtplib\r\nfrom email.mime.text import MIMEText\r\nfrom email.mime.multipart import MIMEMultipart\r\nfrom email.mime.application import MIMEApplication\r\n\r\nsender_passwords = {\r\n    \"local\": \"123password321\",\r\n    \"external\": \"a09eaaBh3\"\r\n}\r\n\r\nrecipient_emails = [\"rahmetova@km.local\", \"mahmutasker@a-biz.kz\"]\r\nsmtp_server_params = {\r\n    \"local\": {\"host\": \"192.168.1.1\", \"port\": 25},\r\n    \"external\": {\"host\": \"192.168.1.100\", \"port\": 25}\r\n}\r\n\r\nfor i in range(len(recipient_emails)):\r\n    message = MIMEMultipart()\r\n    message[\"Subject\"] = f\"{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт\"\r\n    body = \"Результат тестирования КЛО.\"\r\n    message.attach(MIMEText(body, \"plain\"))\r\n\r\n    file_path = f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\n    with open(file_path, \"rb\") as attachment:\r\n        part = MIMEApplication(attachment.read(), Name=f\"{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт\")\r\n\r\n    part[\"Content-Disposition\"] = f'attachment; filename=\"{part[\"Name\"]}\"'\r\n    message.attach(part)\r\n\r\n    recipient_email = recipient_emails[i]\r\n    recipient_domain = recipient_email.split('@')[1]\r\n\r\n    smtp_server_type = \"local\" if recipient_domain == \"km.local\" else \"external\"\r\n\r\n    with smtplib.SMTP(smtp_server_params[smtp_server_type][\"host\"], smtp_server_params[smtp_server_type][\"port\"]) as server:\r\n        sender_email = \"rp@km.local\" if recipient_domain == \"km.local\" else \"rp@km.kz\"\r\n        message[\"From\"] = sender_email\r\n        message[\"To\"] = recipient_email\r\n\r\n        server.login(sender_email, sender_passwords[smtp_server_type])\r\n        server.send_message(message)\r\n        print(f\"Письмо для {recipient_email} отправлено успешно.\")\r\n"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ESvmzN7S9f"},"i6Q_Bv7ozR":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\n\r\nfile_path = f\"{{{data_path}}}Нормы для ВИНКЛО.xlsx\"\r\nemployeer_subdivision = {{employees}}[{{i}}][5]\r\n\r\ndata = pd.read_excel(file_path)\r\nfor row in data.values:\r\n    if row[0] == employeer_subdivision:\r\n        {{manager_mail}} = row[5]\r\n        break"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"t--fqmyZ9f"},"NFqhAQRPGk":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TButton","control_type":"Button","title":"Закрыть"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"i6Q_Bv7ozR"},"-azKNVZoSf":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"data = {%Ca85TD5jnH%}\r\nmd_value  = ''\r\nfor i in data['text']:\r\n    if 'MD' in i:\r\n        md_value = i.replace('MD=', '')\r\n        {{current_md}} = md_value"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"NFqhAQRPGk"},"XYkmJJrnMM":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"data = {%Ca85TD5jnH%}\r\nindex_of_md = data['text'].index('MD')\r\n\r\nmd_value = data['text'][index_of_md + 1].replace('=', '')\r\n\r\n{{current_md}} = md_value"},"breakpoint":false,"if_error":{"go_to":"-azKNVZoSf","repeat":5,"counter":0,"delay":3},"next_id":"NFqhAQRPGk"},"Ca85TD5jnH":{"name":"OCR GET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"ocr_get_texts","func_params":{"langs":["eng"],"image_scaling":1.5,"set_area_width":[1,10],"set_area_height":[1,10],"tesseract_path":"C:\\Program Files\\Tesseract-OCR\\tesseract.exe","wait_appear":null,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TPanel","control_type":"Pane","title":""}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":0,"counter":0,"delay":null},"next_id":"XYkmJJrnMM"},"s0gHeNu5QF":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"enter","timing_after":1,"timing_before":0,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Ca85TD5jnH"},"ZcHAija8rx":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"close","func_params":{"wait_appear":1,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm3"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"s0gHeNu5QF"},"3NzvshH7IP":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import docx\r\nimport zipfile\r\nfrom io import BytesIO\r\nfrom docx import Document\r\nfrom docx.shared import Inches\r\nimport re\r\n\r\ndef process_docx_images(input_path: str, width: int = None, height: int = None) -> docx.Document:\r\n    input_zip = zipfile.ZipFile(input_path)\r\n    output_doc = docx.Document()\r\n\r\n    for file_name in input_zip.namelist():\r\n        if file_name.startswith('word/media/'):\r\n            image_stream = BytesIO(input_zip.read(file_name))\r\n\r\n            if width or height:\r\n                output_doc.add_picture(image_stream, width=width, height=height)\r\n            else:\r\n                output_doc.add_picture(image_stream)\r\n\r\n    return output_doc\r\n\r\ndef format_document(input_path):\r\n    output_doc = process_docx_images(input_path, width=Inches(6), height=Inches(1))\r\n\r\n    doc = Document(input_path)\r\n\r\n    paragraph_starts = [\"Э.\", \"Тр.\", \"Р.\", \"А.\", \"Н.\", \"Q2.\", \"L.\", \"N.\", \"F.\", \"I.\", \"O.\", \"Q4.\", \"C.\", \"G.\", \"Q3.\", \"E.\", \"B.\", \"M.\", \"Q1.\", \"УП.\", \"МД.\", \"УЦ.\", \"ОР.\", \"ОН.\", \"ОК.\"]\r\n\r\n    for para in doc.paragraphs:\r\n        clean_text = re.sub(r'\\s+', ' ', para.text).strip()\r\n        words = clean_text.split()\r\n\r\n        new_text = \"\"\r\n        for word in words:\r\n            if any(word.startswith(start) for start in paragraph_starts):\r\n                if new_text:\r\n                    output_doc.add_paragraph(new_text, style='Normal').alignment = 3\r\n                new_text = \"\\t\" + word + \" \"\r\n            else:\r\n                new_text += word + \" \"\r\n\r\n        if new_text:\r\n            output_doc.add_paragraph(new_text, style='Normal').alignment = 3\r\n\r\n    new_file_path = input_path\r\n    output_doc.save(new_file_path)\r\n    return new_file_path\r\n\r\nsource_file_path = f\"{{{data_path}}}Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\nformatted_file_path = format_document(source_file_path)"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"ZcHAija8rx"},"Cx7rcWeB5G":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import docx\r\nimport zipfile\r\nfrom io import BytesIO\r\nfrom docx.shared import Inches, Pt, RGBColor\r\nfrom docx.enum.text import WD_ALIGN_PARAGRAPH\r\n\r\ndef process_docx_images(input_path: str, width: int = None, height: int = None) -> docx.Document:\r\n    # Чтение исходного документа и создание нового\r\n    input_zip = zipfile.ZipFile(input_path)\r\n    output_doc = docx.Document()\r\n\r\n    # Перебор файлов в архиве и поиск изображений\r\n    for file_name in input_zip.namelist():\r\n        if file_name.startswith('word/media/'):\r\n            image_stream = BytesIO(input_zip.read(file_name))\r\n            if width or height:\r\n                output_doc.add_picture(image_stream, width=width, height=height)\r\n            else:\r\n                output_doc.add_picture(image_stream)\r\n\r\n    # Сохранение нового документа\r\n    return output_doc\r\n\r\ndef process_document(input_path, output_path):\r\n    # Чтение документа\r\n    input_doc = docx.Document(input_path)\r\n    width = Inches(6)\r\n    height = Inches(1.5)\r\n    output_doc = process_docx_images(input_path, width, height)\r\n    paragraph = \"\"\r\n    end = False\r\n\r\n    for index, para in enumerate(input_doc.paragraphs):\r\n        if para.text == '':\r\n            continue\r\n\r\n        if (para.text.startswith(\"Дата тестирования\") or end) and para.text != \"\":\r\n            if not end:\r\n                parag = output_doc.add_paragraph(paragraph)\r\n                parag.paragraph_format.space_after = Pt(2)  # Расстояние после абзаэца\r\n                parag.paragraph_format.space_before = Pt(2) # Расстояние перед абзацем\r\n\r\n            \r\n            parag = output_doc.add_paragraph(para.text)\r\n            parag.paragraph_format.space_after = Pt(2)  # Расстояние после абзаэца\r\n            parag.paragraph_format.space_before = Pt(2)  # Расстояние перед абзацем\r\n            end = True\r\n            continue\r\n\r\n        if index in [1, 2, 3, 4, 5, 8]:\r\n            print(para.text)\r\n            title = output_doc.add_paragraph(para.text)\r\n            title.paragraph_format.space_after = Pt(2)  # Расстояние после абзаэца\r\n            title.paragraph_format.space_before = Pt(2)  # Расстояние перед абзацем\r\n    \r\n\r\n            # Установка стиля заголовка (например, 'Heading 1')\r\n            title.style = 'Heading 1'\r\n\r\n            # Выравнивание параграфа по центру\r\n            title.alignment = WD_ALIGN_PARAGRAPH.CENTER\r\n            for run in title.runs:\r\n                run.font.bold = True\r\n                run.font.size = Pt(10)  # Установка размера шрифта, например, 14 пт\r\n                run.font.color.rgb = RGBColor(0, 0, 0)  # Черный цвет текста\r\n            # paragraph += f'{para.text}\\n'\r\n            continue\r\n        # print(repr(para.text))\r\n        if para.text[0].isdigit():\r\n            paragraph += f\"\\n\\n{para.text}\"\r\n            continue\r\n\r\n        if not (\"\\t\" in para.text):\r\n            print(repr(para.text))\r\n            paragraph += para.text.replace('\\t', ' ')\r\n            continue\r\n\r\n        paragraph += f\"\\n{para.text}\"\r\n\r\n    output_doc.save(output_path)\r\n\r\n# Замените 'path_to_your_document.docx' на путь к вашему файлу\r\ninput_path = f\"{{{data_path}}}Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\noutput_path = 'output.docx'\r\n\r\nprocess_document(input_path, input_path)"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"3NzvshH7IP"},"QhViCTPBeW":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import win32com.client as win32\r\nimport pyperclip\r\nword = win32.Dispatch(\"Word.Application\")\r\ndoc = word.Documents.Open(f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\")\r\nselection = word.Selection\r\nselection.EndKey()\r\nclipboard_text = pyperclip.paste()\r\nif clipboard_text:    \r\n    selection.TypeText(\"\\n\" + clipboard_text)\r\ndoc.Save()\r\ndoc.Close()\r\nword.Quit()"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Cx7rcWeB5G"},"x1SQrQMjuP":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32768","title":"Контекст","backend":"uia"},{"class_name":"","control_type":"MenuItem","title":"Копировать"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"QhViCTPBeW"},"UbAUHRdgDQ":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"right_click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAH0AAAAWCAIAAABi0QTrAAABLElEQVR4nO1XURKFIAiMpvtfmffhjBkIIlbMm9gvy1iXVTQBEbfE69ijBXwU6XsM0vcYpO8xSN9jcNQWAATq+BpyvccgfY/B6Tsi8jtU92ViHbneY3D6Xs7VdnWXdp63TwCq0a3vAMBNJxtO7eIbkT2KDKqzOQSQLLqPJEpiU6iktqKZ7jPd4PZNgaSPdFmiyFj1S9L2CVAgEUoCLJDmhgs7BAaKUgFKPl19w6gbt7IhiT4ZDn+7L1seJX3qe7vPIKKxQnV9s1FDwjcDV6iU9HfpO3vBrmB2FLjCGHVjVSlUU7lc/t83ViZ2IvcM+SaY1+/iNmK/qShU9lys/++VsdXHM+eH5DDKKJdT8fylLn15KoRSlEVnd4izqz67y/DGKv5TAQ7kfTUG6XsMfptPQSoWETbUAAAAAElFTkSuQmCC","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":"","counter":0,"delay":1},"next_id":"x1SQrQMjuP"},"G4tFymTC6q":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32768","title":"Контекст","backend":"uia"},{"class_name":"","control_type":"MenuItem","title":"Выделить все"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"UbAUHRdgDQ"},"tnQrT_1MIS":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"right_click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAH8AAAATCAIAAAA26UVlAAABMUlEQVR4nO1YWw7EIAiUTe9/hl6np3I/TAzlJVo3ZFPmy1UZB6iULpznWRJBOK7ritbwXkCtNVrDe/GJFvBqZPQjkdGPxC36AAAAZIc4mdiCfPYjcYt+63/wk97G2Rf9CELH2SPOQ09KUF/ipclvhVPO028f5BFAvBB/EiuNzaDSxobmIlYekQLPNGgqyZLHipzVd5LxmgADGqEmwAMtQ6Kww8/bboPhlahyaLWxuA1J7JQsRFmcxDy2+0L0ceUBAJ5G4/ihoOft0zLDxs7NT2W7TysP3u2/wk8we0q9w2m18YYZVLO+0H6/sIvjp1vO01qa+Y1+WFj8XzYG1ZQvE/1+58Uquf/8FTq0cormVGLDJi7Zj6pBqFl5dIpHFOTmnv84N97rPxWwhvzWjURGPxJfD/Mwf8RgzrQAAAAASUVORK5CYII=","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":"","counter":0,"delay":1},"next_id":"G4tFymTC6q"},"McUZsvLkjr":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import win32com.client as win32\r\nfrom PIL import ImageGrab\r\nimport os\r\n\r\nword = win32.Dispatch(\"Word.Application\")\r\n\r\ndoc = word.Documents.Add()\r\n\r\nclipboard_img = ImageGrab.grabclipboard()\r\n\r\nif clipboard_img:\r\n    img_path = os.path.join(os.getcwd(), \"clipboard_image.png\")\r\n    clipboard_img.save(img_path, \"PNG\")\r\n\r\n    doc.InlineShapes.AddPicture(img_path, LinkToFile=False, SaveWithDocument=True)\r\n\r\n    os.remove(img_path)\r\n\r\n    doc_name = f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\n    full_path = os.path.join(os.getcwd(), doc_name)\r\n    doc.SaveAs(full_path)\r\n\r\ndoc.Close()\r\nword.Quit()\r\n"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"tnQrT_1MIS"},"_o0aelsptM":{"name":"KILL PROCESS","module":"pyPythonRPA.Robot.pythonRPA","class":"application","function":"kill","func_params":{"process_name":""},"breakpoint":false,"class_params":{"path":"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16"},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"McUZsvLkjr"},"rg2D29tBnu":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import win32com.client as win32\r\nfrom PIL import ImageGrab\r\nimport os\r\n\r\nword = win32.Dispatch(\"Word.Application\")\r\n\r\ndoc = word.Documents.Add()\r\n\r\nclipboard_img = ImageGrab.grabclipboard()\r\n\r\nif clipboard_img:\r\n    img_path = os.path.join(os.getcwd(), \"clipboard_image.png\")\r\n    clipboard_img.save(img_path, \"PNG\")\r\n\r\n    doc.InlineShapes.AddPicture(img_path, LinkToFile=False, SaveWithDocument=True)\r\n\r\n    os.remove(img_path)\r\n\r\n    doc_name = f\"{{{data_path}}}\\\\Отчеты\\\\{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}_отчёт.docx\"\r\n    full_path = os.path.join(os.getcwd(), doc_name)\r\n    doc.SaveAs(full_path)\r\n\r\ndoc.Close()\r\nword.Quit()\r\n"},"breakpoint":false,"if_error":{"go_to":"_o0aelsptM","repeat":3,"counter":0,"delay":5},"next_id":"tnQrT_1MIS"},"LdbJRUyeka":{"name":"IMPORT LIB","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"import_lib","func_params":{"lib":"os","path":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"rg2D29tBnu"},"vCmFEg2hsI":{"name":"IMPORT LIB","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"import_lib","func_params":{"lib":"PIL","path":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"LdbJRUyeka"},"KwIv01TQrT":{"name":"IMPORT LIB","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"import_lib","func_params":{"lib":"pyperclip","path":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"vCmFEg2hsI"},"2H1d151mW7":{"name":"IMPORT LIB","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"import_lib","func_params":{"lib":"win32com.client","path":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"KwIv01TQrT"},"-lai-WkwMo":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32768","title":"Контекст","backend":"uia"},{"class_name":"","control_type":"MenuItem","title":"Копировать"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"2H1d151mW7"},"QGdiOEnu_s":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"right_click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm3","backend":"uia"},{"class_name":"TChart","control_type":"Pane","title":""}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"-lai-WkwMo"},"In5NQqY49p":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"Enter","timing_after":1,"timing_before":1,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"QGdiOEnu_s"},"Zv5PsZcTvp":{"name":"ENTER TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"write","class_params":{},"func_params":{"text":"{{current_norm}}","timing_after":1,"timing_before":0,"timing_between":0.1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"In5NQqY49p"},"jxxkVS8OSz":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":1,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32768","title":"Контекст","backend":"uia"},{"class_name":"","control_type":"MenuItem","title":"Удалить"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Zv5PsZcTvp"},"-L3gpWV2tu":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"right_click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm3","backend":"uia"},{"class_name":"TComboBox","control_type":"ComboBox","title":""},{"class_name":"Edit","control_type":"Edit"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"jxxkVS8OSz"},"UDmfSYIKoS":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"close","func_params":{"wait_appear":1,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm3"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"N4Sx1lKnrG"},"TGH4NRGhkV":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"file_path = f\"{{{data_path}}}Нет_Нормы\\\\Список.txt\"\r\ntext_to_append = f\"{{{employees}}[{{i}}][0]}_{{{employees}}[{{i}}][1]}\"\r\nwith open(file_path, 'a') as file:\r\n    file.write(text_to_append + '\\n')"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"UDmfSYIKoS"},"KlVueT9XwS":{"name":"IF..ELSE","module":"pyPythonRPA.Robot.pythonRPA","class":"conditions","function":"if_else","class_params":{},"func_params":{"condition":"str({{current_norm}}) != 'nan'","if_case":"-L3gpWV2tu","else_case":"TGH4NRGhkV"},"results":null,"object":null,"inherit_object":null,"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"bHIS8MypVF":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\nfile_path = {{data_path}} + 'Нормы для Винкло.xlsx'\r\n\r\ndf = pd.read_excel(file_path)\r\n\r\nfor post in df.values:\r\n    if post[1] == {{employees}}[{{i}}][3]:\r\n        {{current_norm}} = post[2]\r\n        break\r\n    else:\r\n        {{current_norm}} = post[1]"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"KlVueT9XwS"},"n45TuZ9zBr":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAEIAAAAtCAIAAACVlCowAAAEVUlEQVR4nO1YbWxTVRh+7npbu+1u3BXIDMN1MKfhx4jOzMxgMBQzYH4EP1DxK4AkTqLLSFqUNduCYy6hQ7GZmgUCPxQzibGTwnABzWKcwxgyXEgNmZBO3NwYmkFLb729u9cfx911/dio52q7Zc+v5pz3vO/znPd9zzm3jKIomP1ISzYBbcD6fL5kc9AArCzLyeagAeZIUc3LSCXMy0glsJTry7a5KT2cPfwYpQcAzNjY2L9eXLbNzRcVGjjuVowtZXd2ea71Dd2s2lDU9dNQ9sUz77Dt29PfGuu/RK+ENhtegRWhvxVLi96ALI5doAOALA48Dz+8AstTMgBAn42NVesoGbQ7O5OfjcbViwHssln3OZoB+MXJh6YkQ5SZ4cBIUArdnpEHIChBkEDeooIEMtJOyQAAvQwAu2xW9TdnYIgSSQaAtktHms7XibIAoLWk7QHPkFS8Rly4VNWgFTQ4cEkeAPhFJVxDz8gP+/rqPrN83fvE6LsFDfu/enzBlx/l731mPBgk9ooUoI9OoIEMkg2/qHAGBoAkg/nz6rUzh3d0rnemPWvWLzV0fbF5b+3lHP2JPS3ewvyCllcBiOO4v+Yh468/0xOAhtlQyynDuTPzuWVb+61b5NKKH715L9+96MPqwXq3MWPxqSttvsq22wb7s1yNOec6oNPfyFtBTwAa9gbRkPbtcX1Px3vv7+eGO7eucl0FxkdHQoxe4EzOJR2V3WvvyFyhq3GVWEtl4ELlIfroBFr2hiJJ6R/YblS3nB7ufNL8EoCghFBOrsCZFAXmzKI9937aerHGaxDOv+kaqKgaXVlOH51As94AYPi4SSpc+Vdpef91T35mkWqgnrDFOQ8+Za6q7930h/m+y49aBwPewYCXngA0kVHX6ACA3weMx5y+Hc2nf+u4GRLyOTM5TwUJDDNpvHnZ7iz9Qtu51Vu6l9t7LQN+Dz0B0PeGX1TettsAGA9Ue59+Zecvu3tGvmsqbdUx2cRAUf656QCI4wBgLz7muX4213iXyVAA4HMcpeQADbMRKlmz3uReZMz9puKCZckGMhUIAUA6C0xoCEow6rJLTOV5GQX0oVVocFKRy66+78q6tIcNMnvE3ZCgg3voOWggA0BNg0OUmeZ66+u1DgBBCYeabM9bHQAECa4DtkfecMgKAJxqsa19zUHK7PuDtrLtjpN2DYqK9oXb/ckLAESZARCUFEy8lKKfgJioK3WQCKu1H03+C3fVixrsJT2ospE6mCN/KczLSCXMy0glTB64PM+HT8yuE2zKvRFOnef5WaRkzhVVPKjFpiYnYkTNW3gCw20iEhuzeiPsIwyiSyNihI2Yi/YezizCY7zCCxcWPRvtGVP3KKbB9IjbG+GcYpKIZx8T0SmdPkqiHmYuqpjLEt2w6RMYsxoT8pBAi5MA0WFIpc24nf8pZshGeMORPYgewdRKi7ffEUviRYmH6T1o+VBP4lWjwUfsjO37P+Bv3eAbMx0gn9kAAAAASUVORK5CYII=","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"bHIS8MypVF"},"hdkqnlFDM7":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAGkAAAAVCAIAAADKAFfXAAAA/klEQVR4nO2YQQ7EIAhF7aRbo/c/nwfwCF2YGIIU8aeTppG30gYUv1Bbj1prCCGlVEoJzgon7cQY34rji/zeDuDDuHY4rh2Oa4fj2uGccxOJnHNrtE+cPUG0yzl3yWh7N5Ca3VYsBlizI6yKez6yJBVtept5ib4dZiAGw6ajXfZEdNHBtWuT9TnEKra07YyK2y2VfQo3Oz0F127ML2ZgiWP0WjWzn1rKINhb6JmavSvMqXzMa6ydQNJkOoJxrqdYPiuMmdJQ1qy40EX+4xwXtwcYZznvmBxtYXpetPVTG7sc9kqcJh2zxOKhHJXc3/kd1BL+T4bj2uG4djiuHc4F0dDNWfdhXncAAAAASUVORK5CYII=","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"n45TuZ9zBr"},"wxZBWGbUa6":{"name":"FOR..I","module":"pyPythonRPA.Robot.pythonRPA","class":"loop","function":"for_i","class_params":{},"func_params":{"range":[187],"true_case":"QTp1xmWYC5","false_case":"hdkqnlFDM7","index_name":"key","state":{"iteration":0,"i":0,"initial_state":true}},"state":{"iteration":0,"i":0,"initial_state":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"4G1dtYxs0Q":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32770","title":"Winklo7 (1)","backend":"uia"},{"class_name":"Button","control_type":"Button","title":"ОК"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"wxZBWGbUa6"},"npaO4NUXTS":{"name":"WAIT FOR SELECTOR TO APPEAR","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"wait_appear","func_params":{"sec":2},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32770","title":"Winklo7 (1)","backend":"uia"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":"wxZBWGbUa6","repeat":null,"counter":0,"delay":null},"next_id":"4G1dtYxs0Q"},"8PUI4OzyGV":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"iVBORw0KGgoAAAANSUhEUgAAAE8AAAAoCAIAAAAwpzAzAAADdklEQVR4nO1ZPWgUQRT+Zj3UYGK2FUTRwk4EUVQsIhqwEYNgYaFdgqAoBkEE0ULBQpBIxMafxhQqWihepyCKoGAQrrE4tFBEQVTukki8mXnvWaxeNrd7m0vIuyOJX3U3+92b79v35s3unCmVSlgwMCLSag3NQ65cLrdaQ/MQtFpAU5FTijuY/9YIbexDsdPkjh7fqiSjBlpu29tyJ/atMSaLU3z/7dYHLN617drgq+YYVqxk6zmbMF7xAAzz163brw2+1lNSRWvWLTGswBEAGANj8GbjjiYY1nIr7FFnb/OM354twRED+F0eo5GR3Eg5v2qLtmGtdSueUr2SoOLZeiHQss5lAMrDhXagHVgLnMr34DEA/HryQ0OVllv2LjlIjAqxI3HEFUJH2N53bPfPH9+/fPq45/R2JSVxqOWWfM0ICSperBdLYhmOxJJYwqK2zrhVpaxG0KvkiXVrNl2vR9uAz0+Dgejzg4F3z+48u6QkCIBiJU/OLb/pSyGNlvhItxTHx1avf3Xx5ZKoR2tCvZLTmxUAgC/0SrFQQtvbM3lLbDOoswStHYi9ByCA9ekeJH9bnj8C0M3940uXO0adLj6bUNtvvScWSxI9UUn+Nh/aJMXC38ujJb5yEoDpPVvASht1LJ6zbpm89VzxYokB8M3zUizwke4on3x3EKMlrFgd9J0DEFmd425JHIn1ALBoaNis24DREp/azwMn5d5VAEH/5YjsGI5E36xeJTvniCfqsyMMhobNgeMA5F9iTVdPRLbEBCDzhWlWoJdbsgRLcLHeE/RfDi49QEcIIOg9N0FWEpGA2juQSPVpKQ7T1RNVtenaqzV1fajtt4AlCehvlwo235h8/TB23leaOgNabgF4EsPiWF7cP2hZXLQhVR+SWajpx52Kbi0j8GIJ0e7i/lm1JK4VVqFayV5MAEMwHvACB3gYB3EQNsbUnFllH2HNEtTcsjy88Ugp+IxhFtQ/Iwvr9Py/2/mLSV0qDMP41/m3pFO6VBiG889nhAVcyfVQrfBqzuMjyfqPV0f0Oc5JDYLJ6yiDk4xcM5IqOMLUbhufILv+GwnSyMgMBFcvTS+3SWQryPhhNj+Z2yljxsfrcRpyO7OmlazhxidKzX+SU2+ueoKn16Wmdaeb1tgz5qqRN3Vuk/eskbuYurFNGSSDk60wW3AVfwAMIGv6cRxBzwAAAABJRU5ErkJggg==","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"npaO4NUXTS"},"HPgngUbVoq":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"end","timing_after":0.5,"timing_before":0.5,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"8PUI4OzyGV"},"NlOM3Ixq3e":{"name":"ENTER KEYSTROKES","module":"pyPythonRPA.Robot.pythonRPA","class":"keyboard","function":"press","class_params":{},"func_params":{"keys":"tab","timing_after":0.5,"timing_before":1,"n_time":1},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"HPgngUbVoq"},"C6i9-7euMh":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":1,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TButton","control_type":"Button","title":"Сохранить"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"NlOM3Ixq3e"},"jLMZkUNndP":{"name":"DESKTOP SET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"set_text","func_params":{"text":"{{employees}}[{{i}}][4]","wait_appear":1,"set_focus":true},"breakpoint":false,"class_params":{},"inherit_object":"acc0ooVY2x","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"C6i9-7euMh"},"acc0ooVY2x":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TMaskEdit","control_type":"Edit","title":""}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"jLMZkUNndP"},"P1HqEARXz2":{"name":"DESKTOP SET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"set_text","func_params":{"text":"{{employees}}[{{i}}][3]","wait_appear":1,"set_focus":true},"breakpoint":false,"class_params":{},"inherit_object":"nm6iyaWF8h","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"acc0ooVY2x"},"nm6iyaWF8h":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TEdit","control_type":"Edit","title":""}],"regexp":false,"iteration":1},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"P1HqEARXz2"},"MdllXTTODo":{"name":"DESKTOP SET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"set_text","func_params":{"text":"{{employees}}[{{i}}][2]","wait_appear":1,"set_focus":true},"breakpoint":false,"class_params":{},"inherit_object":"QShOKGcvbR","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"nm6iyaWF8h"},"QShOKGcvbR":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TEdit","control_type":"Edit","title":""}],"regexp":false,"iteration":2},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"MdllXTTODo"},"gRjbEAXlZN":{"name":"DESKTOP SET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"set_text","func_params":{"text":"{{employees}}[{{i}}][1]","wait_appear":1,"set_focus":true},"breakpoint":false,"class_params":{},"inherit_object":"WoRSkZ4sJP","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"QShOKGcvbR"},"WoRSkZ4sJP":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TEdit","control_type":"Edit","title":""}],"regexp":false,"iteration":3},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"gRjbEAXlZN"},"YNJt255NJy":{"name":"DESKTOP SET TEXT","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"set_text","func_params":{"text":"{{employees}}[{{i}}][0]","wait_appear":1,"set_focus":true},"breakpoint":false,"class_params":{},"inherit_object":"Tw9YQZZxFW","if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"WoRSkZ4sJP"},"Tw9YQZZxFW":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"},{"class_name":"TPanel","control_type":"Pane","title":""},{"class_name":"TEdit","control_type":"Edit","title":""}],"regexp":false,"iteration":4},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"YNJt255NJy"},"QrNa3adf66":{"name":"CV CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byImage","function":"click","class_params":{"image_path":"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","confidence":0.8,"greyscale":false},"func_params":{},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":1},"next_id":"Tw9YQZZxFW"},"Gk0WgFWvuD":{"name":"KILL PROCESS","module":"pyPythonRPA.Robot.pythonRPA","class":"application","function":"kill","func_params":{"process_name":"1cv8"},"breakpoint":false,"class_params":{"path":"\"C:\\\\Program Files\\\\1cv8\\\\8.3.11.3133\\\\bin\""},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"finish"},"iZ7CWQffkY":{"name":"DESKTOP CLICK","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"click","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"#32770","title":"WinKLO 7.0","backend":"uia"},{"class_name":"Button","control_type":"Button","title":"Да"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"Gk0WgFWvuD"},"2fRJT7dv9B":{"name":"DESKTOP WINDOW ACTION","module":"pyPythonRPA.Robot.pythonRPA","class":"byDesktop","function":"close","func_params":{"wait_appear":0,"set_focus":false},"breakpoint":false,"class_params":{"selector":[{"class_name":"TForm1","title":"WinKLO 7.0","backend":"uia"}],"regexp":false,"iteration":0},"inherit_object":null,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"iZ7CWQffkY"},"N4Sx1lKnrG":{"name":"FOR..I","module":"pyPythonRPA.Robot.pythonRPA","class":"loop","function":"for_i","class_params":{},"func_params":{"range":["len({{employees}})"],"true_case":"QrNa3adf66","false_case":"2fRJT7dv9B","index_name":"i","state":{"iteration":0,"i":0,"initial_state":true}},"state":{"iteration":0,"i":0,"initial_state":true},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"condition"},"WLZSuBw1sc":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\nfile_path = {{data_path}} + 'новая таблица.xlsx'\r\ndata = pd.read_excel(file_path)\r\ndata[['Фамилия', 'Имя', 'Отчество']] = data['ФИО полностью'].str.split(' ', expand=True, n=2)\r\nrequired_columns = ['Фамилия', 'Имя', 'Отчество', 'Выберите ту должность на которую вы  идете при резерве, при трудоустройстве, на перевод', 'Отметка времени', 'Подразделение ']\r\nresult_df = data[required_columns]\r\nresult_df = result_df.rename(columns={'Выберите ту должность на которую вы  идете при резерве, при трудоустройстве, на перевод': 'Должность',    'Отметка времени': 'Дата'})\r\nresult_df['Дата'] = result_df['Дата'].dt.strftime('%d.%m.%y')\r\nresult = result_df.values.tolist()\r\n{{employees}} = result"},"breakpoint":false,"if_error":{"go_to":"2fRJT7dv9B","repeat":null,"counter":0,"delay":null},"next_id":"N4Sx1lKnrG"},"VVsMew78F3":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\n\r\nfile_path = {{data_path}} + \"новая таблица.xlsx\"\r\n\r\ndf = pd.read_excel(file_path)\r\n\r\nfirst_columns = df.iloc[:, :10]\r\nlast_columns = df.iloc[:, 10:]\r\n\r\nfor column in last_columns.columns:\r\n    for index, value in last_columns[column].items():\r\n        if str(value)[0] == \"а\":\r\n            last_columns.at[index, column] = 1\r\n        elif str(value)[0] == \"б\":\r\n            last_columns.at[index, column] = 2\r\n        elif str(value)[0] == \"в\":\r\n            last_columns.at[index, column] = 3\r\n\r\nresult_df = pd.concat([first_columns, last_columns], axis=1)\r\n\r\n{{employees_answers}} = last_columns.values.tolist()\r\nresult_df.to_excel(file_path, index=False)"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":2},"next_id":"WLZSuBw1sc"},"URgAP48Ceu":{"name":"RUN PYTHON SCRIPT","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"script","class_params":{},"func_params":{"code":"import pandas as pd\r\n\r\nfile_path = {{data_path}} + 'КЛО-2 (Ответы).xlsx'\r\nfile_path1 = {{data_path}} + 'Текущий список.xls'\r\n\r\ndf = pd.read_excel(file_path)\r\ndf1 = pd.read_csv(file_path1, encoding='cp1251', delimiter=\"\\t\")\r\n\r\ndf['ФИО полностью'] = df['Фамилия'].str.strip() + ' ' + df['Имя'].str.strip() + ' ' + df['Отчество'].str.strip()\r\nall_names = set(df['ФИО полностью'])\r\ncurrent_names = set(df1['Фамилия, имя, отчество тестируемого'])\r\nres = all_names - current_names\r\n\r\nfiltered_df = df[df['ФИО полностью'].isin(res)]\r\n\r\nfiltered_df.to_excel({{data_path}} + 'новая таблица.xlsx', index=False)"},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":2},"next_id":"VVsMew78F3"},"CNEvreNPQ7":{"name":"IMPORT LIB","module":"pyPythonRPA.Robot.pythonRPA","class":"invoce_code","function":"import_lib","func_params":{"lib":"pandas","path":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"URgAP48Ceu"},"nXT-aCoXyx":{"name":"RUN SCENARIO","module":"pyPythonRPA.Robot.pythonRPA","class":"core","function":"start_scenario","class_params":{},"func_params":{"robot_json":"C:\\Users\\User\\Desktop\\KazMinerals\\KazMinerals\\scripts\\KazMinerals.save_current_winKLO_list.script.json","params":""},"breakpoint":false,"if_error":{"go_to":"CNEvreNPQ7","repeat":null,"counter":0,"delay":null},"next_id":"CNEvreNPQ7"},"9VxYs2Zycn":{"start":true,"name":"RUN SCENARIO","module":"pyPythonRPA.Robot.pythonRPA","class":"core","function":"start_scenario","class_params":{},"func_params":{"robot_json":"C:\\Users\\User\\Desktop\\KazMinerals\\KazMinerals\\scripts\\KazMinerals.open_one_c.script.json","params":""},"breakpoint":false,"if_error":{"go_to":null,"repeat":null,"counter":0,"delay":null},"next_id":"nXT-aCoXyx"}},"configs":{},"credentials":{}}